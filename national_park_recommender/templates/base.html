<!DOCTYPE html>
<html lang="en" class="transition-colors duration-300">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}ParkScout{% endblock %} - National Park Recommender</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🌲</text></svg>">
    <style>
        body.dark {
            background: #18181b;
            color: #e5e7eb;
        }
        .dark .bg-white { background-color: #23272f !important; }
        .dark .text-gray-700, .dark .text-gray-600 { color: #d1d5db !important; }
        .dark .text-green-700 { color: #6ee7b7 !important; }
        .dark .shadow-md, .dark .shadow-lg, .dark .shadow-2xl { box-shadow: 0 2px 16px #0006 !important; }
        .dark .bg-green-600 { background-color: #059669 !important; }
        .dark .bg-green-700 { background-color: #047857 !important; }
        .dark .bg-gray-800 { background-color: #18181b !important; }
        .dark .bg-gray-50, .dark .bg-emerald-50, .dark .bg-teal-50 { background: #23272f !important; }
        .dark .border-gray-300 { border-color: #374151 !important; }
        .dark .bg-blue-100, .dark .bg-green-100, .dark .bg-amber-100, .dark .bg-red-100 { background-color: #23272f !important; }
        .dark .text-blue-700, .dark .text-amber-600, .dark .text-red-500 { color: #38bdf8 !important; }
        .dark .rounded-xl { border-radius: 1rem !important; }
        .dark input, .dark textarea, .dark select { background: #23272f !important; color: #e5e7eb !important; border-color: #374151 !important; }
        .dark .hover\:bg-green-700:hover { background-color: #065f46 !important; }
        .dark .hover\:bg-purple-700:hover { background-color: #6d28d9 !important; }
        .dark .hover\:text-green-200:hover { color: #bbf7d0 !important; }
        .dark .hover\:text-blue-800:hover { color: #60a5fa !important; }
        .dark .hover\:text-green-700:hover { color: #6ee7b7 !important; }
        .dark .hover\:text-purple-300:hover { color: #a78bfa !important; }
        .dark .bg-black { background: #18181b !important; }
        .dark .text-white { color: #e5e7eb !important; }
        .dark .text-gray-300 { color: #a1a1aa !important; }
        .dark .text-gray-400 { color: #d1d5db !important; }
        .dark .text-gray-200 { color: #f3f4f6 !important; }
        .dark .bg-white/80 { background-color: #23272fcc !important; }
        .dark .hover\:text-white:hover { color: #38bdf8 !important; }
        .dark .hover\:text-green-200:hover { color: #6ee7b7 !important; }
        .dark .hover\:text-green-600:hover { color: #6ee7b7 !important; }
        .dark .hover\:text-green-800:hover { color: #34d399 !important; }
        .dark .hover\:text-blue-800:hover { color: #60a5fa !important; }
        .dark .hover\:text-blue-600:hover { color: #38bdf8 !important; }
        .dark .hover\:text-purple-300:hover { color: #a78bfa !important; }
        .dark .hover\:text-gray-700:hover { color: #d1d5db !important; }
        /* Intro animation styles */
        #intro-overlay {
            position: fixed;
            inset: 0;
            background: linear-gradient(120deg, #059669 0%, #10b981 100%);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: opacity 0.8s cubic-bezier(.4,0,.2,1), visibility 0.8s cubic-bezier(.4,0,.2,1);
            will-change: opacity, visibility;
        }
        #intro-logo {
            font-size: 4rem;
            font-weight: 900;
            color: #fff;
            background: linear-gradient(90deg, #fff 60%, #bbf7d0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            opacity: 1;
            animation: introFadeZoom 1.2s cubic-bezier(.4,0,.2,1);
            pointer-events: none;
        }
        @keyframes introFadeZoom {
            0% {
                opacity: 0;
                transform: scale(0.7);
                filter: blur(8px);
            }
            60% {
                opacity: 1;
                transform: scale(1.05);
                filter: blur(0);
            }
            100% {
                opacity: 1;
                transform: scale(1);
                filter: blur(0);
            }
        }
        #intro-logo.move-corner {
            font-size: 2rem;
            left: var(--logo-final-x, 2.2rem);
            top: var(--logo-final-y, 1.6rem);
            transform: translate(0, 0);
            background: linear-gradient(90deg, #059669 60%, #10b981 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        #intro-overlay.hide {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: opacity 0.7s cubic-bezier(.4,0,.2,1), visibility 0.7s cubic-bezier(.4,0,.2,1);
        }
        /* Navbar styles */
        .navbar {
            background: #f8fafc;
            box-shadow: 0 2px 12px #0001;
            border-radius: 0 0 1.2rem 1.2rem;
            padding: 0.7rem 1.2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            z-index: 10;
        }
        .navbar .navbar-brand {
            font-size: 2rem;
            font-weight: 800;
            letter-spacing: -0.03em;
            color: #059669;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: color 0.2s;
            background: linear-gradient(90deg, #059669 60%, #10b981 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .navbar .navbar-links {
            display: flex;
            gap: 1.1rem;
            align-items: center;
        }
        .navbar .navbar-link {
            color: #059669;
            font-weight: 500;
            font-size: 1.08rem;
            padding: 0.4rem 0.9rem;
            border-radius: 0.7rem;
            transition: background 0.18s, color 0.18s;
            text-decoration: none;
        }
        .navbar .navbar-link:hover, .navbar .navbar-link.active {
            background: #e6f9f0;
            color: #047857;
        }
        .navbar .navbar-link.surprise {
            background: #059669;
            color: #fff;
            font-weight: 700;
        }
        .navbar .navbar-link.surprise:hover {
            background: #10b981;
            color: #fff;
        }
        /* Responsive */
        @media (max-width: 700px) {
            .navbar { flex-direction: column; align-items: flex-start; padding: 0.7rem 0.7rem; }
            .navbar .navbar-links { flex-wrap: wrap; gap: 0.5rem; }
            .navbar .navbar-brand { font-size: 1.4rem; }
        }
        @media (max-width: 480px) {
            .navbar .navbar-links { flex-direction: column; width: 100%; }
            .navbar .navbar-link { width: 100%; text-align: left; }
        }
        /* Light mode improvements */
        body {
            background: #f8fafc;
            color: #222;
        }
        .bg-white, .rounded-xl, .shadow-md, .shadow-lg, .shadow-2xl {
            background: #fff !important;
            color: #222 !important;
        }
        /* Add this for dark mode park cards */
        .dark .bg-white,
        .dark .park-card,
        .dark .rounded-xl,
        .dark .shadow-md,
        .dark .shadow-lg,
        .dark .shadow-2xl {
            background-color: #23272f !important;
            color: #e5e7eb !important;
        }
        .text-gray-700, .text-gray-600 { color: #374151 !important; }
        .text-green-700 { color: #059669 !important; }
        .border-gray-300 { border-color: #d1d5db !important; }
        .bg-gray-50, .bg-emerald-50, .bg-teal-50 { background: #f8fafc !important; }
        .rounded-xl { border-radius: 1rem !important; }
        input, textarea, select { background: #fff !important; color: #222 !important; border-color: #d1d5db !important; }
        .hover\:bg-green-700:hover { background-color: #10b981 !important; color: #fff !important; }
        .hover\:text-green-700:hover { color: #059669 !important; }
        .hover\:text-green-600:hover { color: #10b981 !important; }
        .hover\:text-green-800:hover { color: #047857 !important; }
        .hover\:text-blue-800:hover { color: #2563eb !important; }
        .hover\:text-blue-600:hover { color: #3b82f6 !important; }
        .hover\:text-purple-300:hover { color: #a78bfa !important; }
        .hover\:text-gray-700:hover { color: #374151 !important; }
        /* Green theme and improved visibility for text boxes/inputs */
        input[type="text"], input[type="email"], input[type="password"], textarea, select {
            background: #f0fdf4 !important;
            color: #065f46 !important;
            border: 2px solid #10b981 !important;
            border-radius: 0.5rem !important;
            box-shadow: 0 2px 8px #05966911;
            padding: 0.75rem 1rem;
            font-size: 1rem;
            transition: border-color 0.18s, box-shadow 0.18s, background 0.18s;
        }
        input[type="text"]:focus, input[type="email"]:focus, input[type="password"]:focus, textarea:focus, select:focus {
            border-color: #059669 !important;
            background: #bbf7d0 !important;
            color: #065f46 !important;
            outline: none;
            box-shadow: 0 4px 16px #05966922;
        }
        .dark input[type="text"], .dark input[type="email"], .dark input[type="password"], .dark textarea, .dark select {
            background: #23272f !important;
            color: #bbf7d0 !important;
            border-color: #10b981 !important;
        }
        .dark input[type="text"]:focus, .dark input[type="email"]:focus, .dark input[type="password"]:focus, .dark textarea:focus, .dark select:focus {
            background: #065f46 !important;
            color: #bbf7d0 !important;
            border-color: #bbf7d0 !important;
        }
        /* Button fixes for visibility and green theme */
        button, .btn, input[type="submit"], input[type="button"] {
            background: linear-gradient(90deg, #059669 60%, #10b981 100%) !important;
            color: #fff !important;
            border: none !important;
            border-radius: 0.5rem !important;
            font-weight: 600 !important;
            padding: 0.7rem 1.5rem !important;
            box-shadow: 0 2px 8px #05966922;
            transition: background 0.18s, color 0.18s, box-shadow 0.18s;
            cursor: pointer;
        }
        button:hover, .btn:hover, input[type="submit"]:hover, input[type="button"]:hover {
            background: linear-gradient(90deg, #10b981 60%, #059669 100%) !important;
            color: #fff !important;
            box-shadow: 0 4px 16px #05966933;
        }
        .dark button, .dark .btn, .dark input[type="submit"], .dark input[type="button"] {
            background: linear-gradient(90deg, #047857 60%, #059669 100%) !important;
            color: #e5e7eb !important;
        }
        .dark button:hover, .dark .btn:hover, .dark input[type="submit"]:hover, .dark input[type="button"]:hover {
            background: linear-gradient(90deg, #059669 60%, #10b981 100%) !important;
            color: #fff !important;
        }
        /* Fix for checkboxes: revert button styles for checkboxes/radios */
        input[type="checkbox"], input[type="radio"] {
            background: #fff !important;
            color: initial !important;
            border: 2px solid #10b981 !important;
            border-radius: 0.375em !important;
            box-shadow: none !important;
            padding: 0 !important;
            font-size: 1rem !important;
            width: 1.25em !important;
            height: 1.25em !important;
            min-width: 1.25em !important;
            min-height: 1.25em !important;
            display: inline-block !important;
            vertical-align: middle !important;
            cursor: pointer;
            transition: border-color 0.18s, background 0.18s;
        }
        input[type="checkbox"]:checked, input[type="radio"]:checked {
            background: #10b981 !important;
            border-color: #059669 !important;
        }
        input[type="checkbox"]:focus, input[type="radio"]:focus {
            outline: 2px solid #10b981 !important;
            outline-offset: 1px;
        }
        .dark input[type="checkbox"], .dark input[type="radio"] {
            background: #23272f !important;
            border-color: #10b981 !important;
        }
        .dark input[type="checkbox"]:checked, .dark input[type="radio"]:checked {
            background: #10b981 !important;
            border-color: #bbf7d0 !important;
        }
        /* Fix for buttons with only icon: always show icon and text */
        button i, .btn i {
            margin-right: 0.5em;
        }
    </style>
    {% block head_extra %}{% endblock %}
</head>
<body class="bg-gradient-to-br from-green-50 via-emerald-50 to-teal-50 text-gray-800 antialiased transition-colors duration-300">
    <div id="intro-overlay">
        <span id="intro-logo"><span style="font-size:1.2em;">🌲</span> ParkScout</span>
    </div>
    <nav class="navbar">
        <a href="{{ url_for('welcome') }}" class="navbar-brand" id="navbar-logo"><span>🌲</span> ParkScout</a>
        <div class="navbar-links">
            <a href="{{ url_for('index') }}" class="navbar-link">Discover</a>
            <a href="{{ url_for('parks') }}" class="navbar-link">All Parks</a>
            <a href="{{ url_for('map_page') }}" class="navbar-link">Map</a>
            <a href="{{ url_for('gallery') }}" class="navbar-link">Gallery</a>
            <a href="{{ url_for('about') }}" class="navbar-link">About</a>
            {% if current_user.is_authenticated %}
                <a href="{{ url_for('profile') }}" class="navbar-link">Profile</a>
                <a href="{{ url_for('logout') }}" class="navbar-link">Logout</a>
            {% else %}
                <a href="{{ url_for('login') }}" class="navbar-link">Login</a>
                <a href="{{ url_for('register') }}" class="navbar-link">Register</a>
            {% endif %}
            <a href="#" onclick="window.location.href='/random_park';return false;" class="navbar-link surprise">Surprise Me!</a>
        </div>
    </nav>

    <main class="container mx-auto p-4 md:p-6 lg:p-8 min-h-[calc(100vh-160px)] transition-colors duration-300">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                <div class="alert-{{ category }} bg-blue-100 border-l-4 border-blue-500 text-blue-700 p-4 mb-4 rounded-md" role="alert">
                    <p>{{ message }}</p>
                </div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        <div id="global-message-area" class="fixed top-20 right-5 z-[100] w-auto max-w-xs"></div>
        {% block content %}{% endblock %}
    </main>

    <footer class="bg-gray-800 text-gray-300 text-center p-6 mt-auto">
        <p>&copy; <span id="current-year"></span> ParkScout by <a href="https://github.com/thomas1424" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-gray-200">Thomas Pan</a>. Happy Exploring!</p>
        <p class="text-sm">Icons by <a href="https://fontawesome.com/" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-gray-200">Font Awesome</a>.</p>
        <p class="text-sm">Powered by <a href="https://flask.palletsprojects.com/" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-gray-200">Flask</a> and <a href="https://tailwindcss.com/" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-gray-200">Tailwind CSS</a>.</p>
        <p class="text-sm">This project is open-source. Check it out on <a href="https://github.com/thomas1424/park-scout" target="_blank" rel="noopener noreferrer" class="text-gray-400 hover:text-gray-200">Github</a></p>
        <p class="text-sm">This project is not affiliated with the National Park Service.</p>
        <p class="text-sm">For any inquiries, please contact <a href="mailto:panthomas1424@gmail.com" class="email-contact-link">Thomas Pan</a></p>
        <div class="mt-4 text-left max-w-2xl mx-auto">
            <h3 class="text-green-400 font-bold mb-1">What's New?</h3>
            <ul class="text-sm text-gray-200 list-disc ml-6">
                <li>🌍 <b>All Parks</b> page: Browse every park in our database!</li>
                <li>🖼️ Improved Gallery: See all parks with better images.</li>
                <li>✨ Features: Like parks, random park button, find closest park (coming soon!), and more.</li>
                <li>🐞 Bug fixes and image reliability improvements.</li>
            </ul>
        </div>
    </footer>

    <!-- Floating action button: Only Dark Mode (ParkScout AI removed) -->
    <div style="position:fixed;bottom:1.5rem;right:1.5rem;z-index:50;">
        <button id="dark-mode-toggle" class="px-4 py-3 rounded-full bg-gray-900 text-white shadow-lg hover:bg-gray-700 transition flex items-center" title="Toggle dark mode" style="box-shadow:0 4px 24px #0006;">
            <i id="dark-mode-icon" class="fas fa-moon"></i>
            <span id="dark-mode-label" class="hidden md:inline">Dark Mode</span>
        </button>
    </div>
    <script>
        document.getElementById('current-year').textContent = new Date().getFullYear();
    </script>
    <script>
        // Dark mode toggle with icon and label swap
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        const darkModeIcon = document.getElementById('dark-mode-icon');
        const darkModeLabel = document.getElementById('dark-mode-label');
        function setDarkMode(on) {
            if (on) {
                document.body.classList.add('dark');
                document.documentElement.classList.add('dark');
                localStorage.setItem('darkMode', '1');
                darkModeIcon.classList.remove('fa-moon');
                darkModeIcon.classList.add('fa-sun');
                darkModeLabel.textContent = 'Light Mode';
                darkModeToggle.title = "Toggle light mode";
            } else {
                document.body.classList.remove('dark');
                document.documentElement.classList.remove('dark');
                localStorage.setItem('darkMode', '0');
                darkModeIcon.classList.remove('fa-sun');
                darkModeIcon.classList.add('fa-moon');
                darkModeLabel.textContent = 'Dark Mode';
                darkModeToggle.title = "Toggle dark mode";
            }
        }
        darkModeToggle.addEventListener('click', () => {
            setDarkMode(!document.body.classList.contains('dark'));
        });
        // On load, set dark mode if user previously enabled it
        if (localStorage.getItem('darkMode') === '1') {
            setDarkMode(true);
        } else {
            setDarkMode(false);
        }
    </script>
    <script>
        // New intro animation: fade/zoom only, no logo move
        window.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                document.getElementById('intro-overlay').classList.add('hide');
            }, 1400);
        });
    </script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    {% block scripts %}{% endblock %}
</body>
</html>